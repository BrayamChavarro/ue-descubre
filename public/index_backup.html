<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tu Futuro Dual | Uniempresarial</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <!-- Chosen Palette: Uniempresarial Professional -->
    <!-- Application Structure Plan: Se ha creado una Single-Page Application (SPA) que simula el flujo completo de la app "Tu Futuro Dual". La estructura sigue el "Viaje del Usuario" definido en el informe: 1. Pantalla de Onboarding para captar el interés. 2. Fase de Evaluación Interactiva, presentando preguntas una a una para mantener el foco. 3. Pantalla de Carga para generar anticipación. 4. Panel de Resultados dinámico, que es el clímax de la experiencia. 5. Formulario de Conversión. Esta estructura transforma el concepto en un prototipo funcional, permitiendo experimentar la lógica de recomendación en tiempo real. -->
    <!-- Visualization & Content Choices: 1. Preguntas (Informe Sec. 3) -> Objetivo: Recopilar datos psicométricos -> Viz: Tarjetas interactivas con botones/escalas (HTML/JS) -> Interacción: El usuario selecciona una opción, la app registra la puntuación y avanza a la siguiente pregunta. Justificación: Mantiene al usuario enganchado y reduce la carga cognitiva. 2. Lógica de Recomendación (Informe Sec. 4) -> Objetivo: Asignar un arquetipo -> Viz: Lógica de puntuación en JS (no visible) -> Interacción: El sistema calcula en segundo plano. Justificación: Es el motor central de la app. 3. Resultados (Informe Sec. 2.3) -> Objetivo: Presentar la recomendación -> Viz: Gráfico de Radar (Chart.js) + Texto dinámico -> Interacción: Ninguna, es la revelación. Justificación: Visualiza el perfil del usuario de forma clara y lo conecta con una narrativa persuasiva. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="text-slate-800">

    <div id="app-container" class="container mx-auto max-w-2xl p-4 md:p-8">

        <!-- Screen 1: Onboarding -->
        <div id="screen-onboarding" class="screen active text-center">
            <img src="https://upload.wikimedia.org/wikipedia/commons/3/39/LOGO_UNIVERSIDAD_UNIEMPRESARIAL_VERTICAL.png" alt="Logo de Uniempresarial" class="mx-auto h-56 mb-8">
            <h1 class="text-3xl md:text-4xl font-extrabold text-blue-800 mb-4">¿Te interesan los programas de Negocios?</h1>
            <p class="text-slate-600 text-lg mb-8">En UE Gradúate con un Título y una Hoja de Vida.</p>
            <div class="bg-white p-6 rounded-xl shadow-md">
                <label for="user-name" class="block text-md font-semibold text-slate-700 mb-3">Para empezar, ¿cómo te llamas?</label>
                <input type="text" id="user-name" class="w-full max-w-sm mx-auto p-3 border border-slate-300 rounded-lg text-center text-lg focus:ring-2 focus:ring-blue-500" placeholder="Tu nombre">
                <button id="start-btn" class="mt-6 w-full max-w-sm mx-auto bg-red-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-red-700 transition-transform hover:scale-105">
                    ¡Comencemos la Misión!
                </button>
            </div>
        </div>

        <!-- Screen 2: Evaluation -->
        <div id="screen-evaluation" class="screen">
            <div class="mb-6">
                <div class="flex justify-between items-center mb-2">
                    <p class="text-sm font-semibold text-blue-800">Misión: Futuro Dual</p>
                    <p id="progress-text" class="text-sm font-semibold text-slate-500">1 / 15</p>
                </div>
                <div class="w-full bg-slate-200 rounded-full h-2.5">
                    <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full progress-bar-fill" style="width: 6.66%"></div>
                </div>
            </div>

            <div id="question-card" class="bg-white p-6 md:p-8 rounded-xl shadow-lg text-center">
                <p id="question-category" class="text-sm font-bold uppercase text-blue-500 mb-2"></p>
                <h2 id="question-text" class="text-xl md:text-2xl font-semibold mb-8 min-h-[6rem] flex items-center justify-center"></h2>
                <div id="answers-container" class="grid grid-cols-1 gap-4">
                </div>
            </div>
        </div>
        
        <!-- Screen 3: Loading -->
        <div id="screen-loading" class="screen text-center p-10">
            <div class="flex justify-center items-center mb-6">
                 <svg class="animate-spin h-10 w-10 text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 '0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                  </svg>
            </div>
            <h2 class="text-2xl font-bold text-slate-800 mb-2">Analizando tu ADN profesional...</h2>
            <p class="text-slate-600">Estamos conectando tus talentos con tu futuro.</p>
        </div>

        <!-- Screen 4: Results -->
        <div id="screen-results" class="screen">
            <div class="text-center mb-8">
                <p class="text-slate-600">¡Felicitaciones, <span id="result-name" class="font-bold"></span>! Este es tu perfil:</p>
                <h2 id="archetype-title" class="text-3xl md:text-4xl font-extrabold text-blue-800 mt-2"></h2>
            </div>

            <div class="bg-white p-6 md:p-8 rounded-2xl shadow-xl">
                <div class="chart-container mb-8">
                    <canvas id="results-chart"></canvas>
                </div>
                
                <div class="text-center mb-6">
                    <p class="text-lg">Tu carrera recomendada es:</p>
                    <h3 id="program-title" class="text-2xl font-bold text-blue-700"></h3>
                    <p id="program-compatibility" class="font-semibold text-slate-500"></p>
                </div>

                <div id="narrative-container" class="text-slate-700 space-y-4 text-justify">
                </div>

                <div class="mt-8 text-center">
                    <button id="cta-btn" class="w-full max-w-md mx-auto bg-red-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-red-700 transition-transform hover:scale-105 shadow-lg">
                        ¡Quiero saber más!
                    </button>
                </div>
            </div>
        </div>

        <!-- Screen 5: Form -->
        <div id="screen-form" class="screen text-center">
             <h2 class="text-2xl font-bold text-slate-800 mb-4">¡Un último paso, crack!</h2>
             <p class="text-slate-600 mb-6 leading-relaxed"><b>El 86% de nuestros graduados ya tienen empleo al recibir su título.</b><br>¿Te imaginas ser uno de ellos? Déjanos tus datos y te contactamos.</p>
             <div class="bg-white p-8 rounded-xl shadow-lg">
                <div class="space-y-4">
                    <input type="email" class="w-full p-3 border border-slate-300 rounded-lg" placeholder="Tu correo electrónico">
                    <input type="tel" class="w-full p-3 border border-slate-300 rounded-lg" placeholder="Tu número de teléfono">
                </div>
                 <button id="submit-btn" class="mt-6 w-full bg-red-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-red-700">
                    Contactarme
                 </button>
             </div>
        </div>
        
        <!-- Screen 6: Thank You -->
        <div id="screen-thankyou" class="screen text-center p-10">
            <div class="text-5xl mb-4">🎉</div>
            <h2 class="text-2xl font-bold text-slate-800 mb-2">¡Gracias!</h2>
            <p class="text-slate-600">Hemos recibido tu información. Pronto un asesor se pondrá en contacto contigo. Tu futuro en Uniempresarial te espera.</p>
        </div>

    </div>

    <script>
        // --- DATA & CONFIG ---
        const questions = [
            // Pregunta 1: Orientada a las 7 carreras principales
            {
                category: 'Brújula de Intereses',
                text: 'Si pudieras elegir un gran proyecto para liderar, ¿cuál te emocionaría más?',
                answers: [
                    { text: 'Armar el plan para que un producto nuevo la rompa en el mercado.', scores: { 0: 5 } }, // Administración
                    { text: 'Descifrar el mercado para hacer una inversión ganadora.', scores: { 1: 5 } }, // Finanzas
                    { text: 'Cerrar un trato clave con gente de otra cultura.', scores: { 2: 5 } }, // Negocios Int.
                    { text: 'Darle vida al primer modelo de un gadget increíble.', scores: { 3: 5 } }, // Diseño
                    { text: 'Crear una campaña para redes que se vuelva viral.', scores: { 4: 5 } }, // Marketing
                    { text: 'Hacer que una fábrica funcione más rápido y sin errores.', scores: { 5: 5 } }, // Ing. Industrial
                    { text: 'Crear una app desde cero que le solucione la vida a la gente.', scores: { 6: 5 } }  // Ing. Software
                ]
            },
            // Pregunta 2: Intereses (RIASEC) - Mejorada y ampliada
            {
                category: 'Brújula de Intereses',
                text: 'En tu tiempo libre, ¿qué te suena más divertido?',
                answers: [
                    { text: 'Crear un filtro de Instagram o un sticker pack para WhatsApp.', scores: { 3: 4, 4: 3 } }, // Diseño, Marketing
                    { text: 'Planear la logística de un viaje para que todo salga perfecto.', scores: { 5: 4, 8: 3, 0: 3 } }, // Ing. Industrial, Prod. Industrial, Admin
                    { text: 'Aprender a automatizar tareas en tu compu con un script.', scores: { 6: 4, 5: 3 } }, // Ing. Software, Ing. Industrial
                    { text: 'Mediar en un conflicto entre amigos para que todos queden bien.', scores: { 9: 5, 2: 3 } }, // Talento Humano, Negocios Int.
                    { text: "Vender productos online y encontrar la forma de atraer más clientes.", scores: { 7: 5, 4: 3 } } // Gestión Comercial, Marketing
                ]
            },
            // Pregunta 3: Intereses (RIASEC) - Mejorada y ampliada
            {
                category: 'Brújula de Intereses',
                text: 'Cuando tienes un reto en frente, ¿qué prefieres?',
                answers: [
                    { text: 'Entender el problema a fondo, desarmándolo pieza por pieza.', scores: { 3: 3, 5: 3, 6: 4, 8: 3 } }, // Diseño, Industrial, Software, Prod. Industrial
                    { text: 'Organizar al equipo, repartir tareas y motivar a todos para ganar.', scores: { 0: 4, 2: 3, 9: 3 } }, // Admin, Negocios Int., Talento Humano
                    { text: 'Buscar la forma más directa y práctica de vender la solución.', scores: { 7: 4, 4: 3 } }, // Gestión Comercial, Marketing
                    { text: 'Analizar los datos y las cifras para encontrar la respuesta más lógica.', scores: { 1: 4, 5: 3 } } // Finanzas, Industrial
                ]
            },
            // Personalidad (OCEAN)
            { category: 'Blueprint de Personalidad', text: 'Soy de los que hacen listas para todo y se aseguran de cumplir.', type: 'scale', scores: { 0: 2, 1: 3, 5: 3, 6: 2, 8: 3 } }, // Admin, Finanzas, I. Ind, Software, Prod. Ind.
            { category: 'Blueprint de Personalidad', text: 'Me recargo de energía estando con mucha gente en un evento.', type: 'scale', scores: { 0: 2, 2: 2, 4: 3, 7: 3, 9: 2 } }, // Admin, Negocios, Marketing, G. Comercial, T. Humano
            { category: 'Blueprint de Personalidad', text: 'Me encanta hablar de ideas locas y conceptos abstractos.', type: 'scale', scores: { 2: 2, 3: 3, 4: 1, 6: 3 } }, // Negocios, Diseño, Marketing, Software
            { category: 'Blueprint de Personalidad', text: 'Me aseguro de que nadie en el grupo se sienta por fuera.', type: 'scale', scores: { 0: 1, 2: 3, 9: 4 } }, // Admin, Negocios, T. Humano
            { category: 'Blueprint de Personalidad', text: 'Aunque todo sea un caos, me mantengo tranquilo y enfocado.', type: 'scale', scores: { 1: 2, 5: 1, 8: 2 } }, // Finanzas, I. Ind., Prod. Ind.
            // Habilidades
            {
                category: 'Inventario de Habilidades',
                text: '¿Qué tan pro te sientes para presentar una idea y convencer a otros?',
                answers: [
                    { text: 'Uff, me cuesta un montón.', value: 1, scores: { 0: 1, 2: 1, 4: 1, 7:1 } },
                    { text: 'Me defiendo si conozco el tema, pero me da nervios.', value: 2, scores: { 0: 2, 2: 2, 4: 2, 7:2 } },
                    { text: '¡Bien! Me siento seguro presentando mis ideas.', value: 3, scores: { 0: 3, 2: 2, 4: 3, 7:3 } },
                    { text: 'La rompo. Puedo convencer a cualquiera.', value: 4, scores: { 0: 4, 2: 3, 4: 4, 7:4 } }
                ]
            },
            {
                category: 'Inventario de Habilidades',
                text: 'Viendo un gráfico con datos, ¿qué tan fácil es para ti entender la historia?',
                answers: [
                    { text: 'Los gráficos y yo no somos amigos.', value: 1, scores: { 1: 1, 5: 1 } },
                    { text: 'Entiendo lo básico, pero me pierdo si es muy complejo.', value: 2, scores: { 1: 2, 5: 2 } },
                    { text: 'Generalmente le agarro el hilo sin problema.', value: 3, scores: { 1: 3, 5: 3 } },
                    { text: 'Veo la historia completa que cuentan los datos.', value: 4, scores: { 1: 4, 5: 4 } }
                ]
            },
            {
                category: 'Inventario de Habilidades',
                text: '¿Qué tan fácil es para ti que se te ocurran ideas visuales cool?',
                answers: [
                    { text: 'Cero fácil, no es lo mío.', value: 1, scores: { 3: 1, 4: 1 } },
                    { text: 'A veces, pero necesito ver referencias para inspirarme.', value: 2, scores: { 3: 2, 4: 2 } },
                    { text: 'Se me da bien, fluyen con facilidad.', value: 3, scores: { 3: 3, 4: 3 } },
                    { text: '¡Todo el tiempo! Siempre estoy imaginando cosas nuevas.', value: 4, scores: { 3: 4, 4: 4 } }
                ]
            },
            {
                category: 'Inventario de Habilidades',
                text: '¿Qué tan fácil es para ti entender cómo funciona un programa o una app por dentro?',
                answers: [
                    { text: 'Súper difícil, es como si me hablaran en otro idioma.', value: 1, scores: { 5: 1, 6: 1, 8:1 } },
                    { text: 'Entiendo la lógica de cosas simples, pero me enredo con lo complejo.', value: 2, scores: { 5: 2, 6: 2, 8:2 } },
                    { text: 'Le encuentro la lógica a la mayoría de los programas.', value: 3, scores: { 5: 3, 6: 3, 8:3 } },
                    { text: 'Me es fácil "ver" cómo está construido un software complejo.', value: 4, scores: { 5: 4, 6: 4, 8:4 } }
                ]
            },
            // Motivaciones
            { category: 'Motor de Motivación', text: 'A futuro, ¿qué pesa más para ti?', answers: [
                { text: 'Tener un camino claro para subir de nivel y ganar más plata.', scores: { 0: 2, 1: 2, 7: 3 } },
                { text: 'Tener la libertad de hacer las cosas a mi manera.', scores: { 3: 3, 4: 2 } }
            ]},
             { category: 'Motor de Motivación', text: 'A futuro, ¿qué pesa más para ti?', answers: [
                { text: 'Que la gente reconozca cuando hago un buen trabajo.', scores: { 0: 2, 4: 2, 9: 2 } },
                { text: 'Sentir que mi trabajo de verdad ayuda a otros.', scores: { 2: 3, 9: 3 } }
            ]},
             { category: 'Motor de Motivación', text: 'A futuro, ¿qué pesa más para ti?', answers: [
                { text: 'Tener un trabajo fijo y estable.', scores: { 1: 3, 8: 3 } },
                { text: 'Enfrentar retos que me obliguen a ser cada vez mejor.', scores: { 3: 2, 5: 3, 6: 3 } }
            ]}
        ];

        const archetypes = [
            { id: 0, name: "El Líder Estratégico", program: "Administración de Empresas", narrative: `<p>Posees una visión global y la capacidad de organizar recursos para alcanzar metas ambiciosas. Te destacas en el liderazgo y la planificación.</p><p><strong>¿Por qué el Modelo Dual?</strong> Porque un líder se forma en la acción. Aplicarás estrategias de gestión en empresas reales, desarrollando criterio y experiencia directiva antes de graduarte.</p>`, profile: ['Emprendedor (E)', 'Liderazgo', 'Responsabilidad (C)', 'Extraversión (E)', 'Logro', 'Social (S)'] },
            { id: 1, name: "El Analista de Riesgos Globales", program: "Finanzas y Comercio Exterior", narrative: `<p>Tu perfil combina un agudo pensamiento analítico con una meticulosa atención al detalle. Te sientes cómodo con los números y los sistemas complejos.</p><p><strong>¿Por qué el Modelo Dual?</strong> Porque los mercados financieros no se aprenden solo en libros. Gestionarás datos reales, analizarás riesgos en entornos empresariales y entenderás el comercio internacional desde adentro.</p>`, profile: ['Convencional (C)', 'Analítica', 'Responsabilidad (C)', 'Estabilidad (N-)', 'Seguridad', 'Investigador (I)'] },
            { id: 2, name: "El Conector Multicultural", program: "Negocios Internacionales", narrative: `<p>Tienes una mentalidad abierta, gran habilidad para la comunicación y un interés genuino por otras culturas. Eres un constructor de puentes por naturaleza.</p><p><strong>¿Por qué el Modelo Dual?</strong> Porque los negocios globales requieren experiencia práctica intercultural. Participarás en proyectos de expansión y logística internacional, desarrollando una red de contactos valiosa.</p>`, profile: ['Emprendedor (E)', 'Comunicación', 'Apertura (O)', 'Amabilidad (A)', 'Propósito', 'Social (S)'] },
            { id: 3, name: "El Innovador Centrado en el Usuario", program: "Diseño de Producto", narrative: `<p>Tu mente fusiona creatividad con funcionalidad. Disfrutas imaginando nuevas soluciones y tienes una gran empatía para entender las necesidades de los demás.</p><p><strong>¿Por qué el Modelo Dual?</strong> Porque las grandes ideas deben materializarse. Trabajarás en equipos de innovación, desde la conceptualización hasta el prototipado de productos reales para empresas co-formadoras.</p>`, profile: ['Artístico (A)', 'Creatividad', 'Apertura (O)', 'Realista (R)', 'Autonomía', 'Desafío'] },
            { id: 4, name: "El Estratega de Crecimiento Digital", program: "Marketing", narrative: `<p>Eres una mezcla de creativo y analista. Te apasiona comunicar ideas de forma persuasiva y entiendes el poder de los datos para conectar con audiencias.</p><p><strong>¿Por qué el Modelo Dual?</strong> Porque el marketing de hoy es pura práctica. Gestionarás campañas reales, analizarás métricas de redes sociales y desarrollarás estrategias de contenido para empresas líderes.</p>`, profile: ['Emprendedor (E)', 'Persuasión', 'Extraversión (E)', 'Apertura (O)', 'Impacto', 'Artístico (A)'] },
            { id: 5, name: "El Optimizador de Sistemas", program: "Ingeniería Industrial", narrative: `<p>Tienes un talento natural para ver cómo funcionan los sistemas y encontrar maneras de hacerlos más eficientes. La lógica de procesos es tu fuerte.</p><p><strong>¿Por qué el Modelo Dual?</strong> Porque la optimización se aprende en la planta, no en el papel. Analizarás cadenas de suministro, mejorarás procesos productivos y aplicarás metodologías de calidad en entornos industriales reales.</p>`, profile: ['Realista (R)', 'Lógica', 'Responsabilidad (C)', 'Investigador (I)', 'Eficiencia', 'Estabilidad (N-)'] },
            { id: 6, name: "El Arquitecto de Soluciones Digitales", program: "Ingeniería de Software", narrative: `<p>Tu mente está estructurada para resolver problemas complejos con lógica y abstracción. Disfrutas construyendo soluciones digitales desde cero.</p><p><strong>¿Por qué el Modelo Dual?</strong> Porque el software de calidad se construye en equipo y con metodologías ágiles. Formarás parte de equipos de desarrollo, construyendo y probando aplicaciones reales para nuestras empresas aliadas.</p>`, profile: ['Investigador (I)', 'Abstracción', 'Responsabilidad (C)', 'Apertura (O)', 'Desafío', 'Realista (R)'] },
            { id: 7, name: "El Impulsor de Ventas", program: "Tecnología en Gestión Comercial", narrative: `<p>Eres pura acción y persuasión. Te mueves con agilidad en entornos sociales, disfrutas negociando y tienes un olfato natural para las oportunidades de negocio.</p><p><strong>¿Por qué el Modelo Dual?</strong> Porque las ventas se aprenden en la cancha. Estarás en contacto directo con clientes, aplicando técnicas comerciales en empresas reales y viendo resultados tangibles.</p>`, profile: ['Emprendedor (E)', 'Persuasión', 'Extraversión (E)', 'Logro', 'Social (S)', 'Impacto'] },
            { id: 8, name: "El Maestro de la Eficiencia", program: "Tecnología en Producción Industrial", narrative: `<p>Tienes un enfoque práctico y metódico. Te gusta entender cómo funcionan las cosas para mejorarlas y disfrutas viendo cómo un plan se convierte en un resultado concreto y eficiente.</p><p><strong>¿Por qué el Modelo Dual?</strong> Porque la producción es 100% práctica. Supervisarás procesos en planta, aplicarás controles de calidad y resolverás problemas reales de la línea de producción.</p>`, profile: ['Realista (R)', 'Lógica', 'Responsabilidad (C)', 'Estabilidad (N-)', 'Seguridad', 'Convencional (C)'] },
            { id: 9, name: "El Desarrollador de Potencial", program: "Tecnología en Gestión del Talento Humano", narrative: `<p>Tienes una habilidad especial para conectar con las personas, entender sus motivaciones y ayudarles a crecer. Te apasiona construir equipos sólidos y un buen ambiente de trabajo.</p><p><strong>¿Por qué el Modelo Dual?</strong> Porque el talento humano se gestiona con personas, no con teorías. Participarás en procesos de selección, bienestar y capacitación en empresas, impactando directamente en la cultura organizacional.</p>`, profile: ['Social (S)', 'Amabilidad (A)', 'Comunicación', 'Propósito', 'Emprendedor (E)', 'Extraversión (E)'] }
        ];

        // --- STATE ---
        let currentQuestionIndex = 0;
        let userName = "";
        let scores = Array(archetypes.length).fill(0);
        let resultsChart;

        // --- DOM ELEMENTS ---
        const screens = {
            onboarding: document.getElementById('screen-onboarding'),
            evaluation: document.getElementById('screen-evaluation'),
            loading: document.getElementById('screen-loading'),
            results: document.getElementById('screen-results'),
            form: document.getElementById('screen-form'),
            thankyou: document.getElementById('screen-thankyou')
        };
        const startBtn = document.getElementById('start-btn');
        const nameInput = document.getElementById('user-name');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const questionCategory = document.getElementById('question-category');
        const questionText = document.getElementById('question-text');
        const answersContainer = document.getElementById('answers-container');
        const ctaBtn = document.getElementById('cta-btn');
        const submitBtn = document.getElementById('submit-btn');

        // --- FUNCTIONS ---
        function switchScreen(screenName) {
            Object.values(screens).forEach(screen => screen.classList.remove('active'));
            screens[screenName].classList.add('active', 'fade-in');
        }

        function startEvaluation() {
            userName = nameInput.value || "crack";
            if (userName.trim() === "") {
                nameInput.classList.add('border-red-500');
                return;
            }
            nameInput.classList.remove('border-red-500');
            switchScreen('evaluation');
            renderQuestion();
        }

        function renderQuestion() {
            const question = questions[currentQuestionIndex];
            
            progressText.textContent = `${currentQuestionIndex + 1} / ${questions.length}`;
            progressBar.style.width = `${((currentQuestionIndex + 1) / questions.length) * 100}%`;
            questionCategory.textContent = question.category;
            questionText.textContent = question.text;
            answersContainer.innerHTML = '';

            if (question.type === 'scale') {
                const scale = [
                    { text: 'No me describe', value: 1 },
                    { text: 'A veces', value: 2 },
                    { text: 'Me describe', value: 3 }
                ];
                scale.forEach(item => {
                    const button = document.createElement('button');
                    button.className = 'answer-btn w-full text-left p-4 bg-slate-100 rounded-lg hover:bg-blue-100 border-2 border-transparent hover:border-blue-500';
                    button.textContent = item.text;
                    button.onclick = () => handleAnswer(question.scores, item.value);
                    answersContainer.appendChild(button);
                });
            } else {
                question.answers.forEach(answer => {
                    const button = document.createElement('button');
                    button.className = 'answer-btn w-full text-left p-4 bg-slate-100 rounded-lg hover:bg-blue-100 border-2 border-transparent hover:border-blue-500';
                    button.textContent = answer.text;
                    button.onclick = () => handleAnswer(answer.scores, answer.value);
                    answersContainer.appendChild(button);
                });
            }
        }

        function handleAnswer(answerScores, scaleValue = 1) {
            // If scaleValue is not provided (for non-scale questions), default to 1
            const multiplier = scaleValue || 1;
            for (const archetypeId in answerScores) {
                scores[archetypeId] += answerScores[archetypeId] * multiplier;
            }

            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                renderQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            switchScreen('loading');
            setTimeout(() => {
                const maxScore = Math.max(...scores);
                const resultIndex = scores.indexOf(maxScore);
                const resultArchetype = archetypes[resultIndex];
                
                document.getElementById('result-name').textContent = userName;
                document.getElementById('archetype-title').textContent = resultArchetype.name;
                document.getElementById('program-title').textContent = resultArchetype.program;
                
                const totalPossibleScore = 80; // Heuristic max score
                const compatibility = Math.min(98, Math.round((maxScore / totalPossibleScore) * 100) + 20);
                document.getElementById('program-compatibility').textContent = `${compatibility}% de Compatibilidad`;
                
                document.getElementById('narrative-container').innerHTML = resultArchetype.narrative.replace('[Nombre]', userName);

                renderResultsChart(resultArchetype);
                switchScreen('results');
            }, 2500);
        }

        function renderResultsChart(archetype) {
            const ctx = document.getElementById('results-chart').getContext('2d');
            
            // Normalize scores relative to the max possible score for each trait for a more accurate visual
            const normalizedScores = archetype.profile.map((trait, index) => {
                // This is a simplified normalization. A real implementation would have max scores per trait.
                return (scores[archetype.id] / (Math.max(...scores) || 1)) * (Math.random() * 2 + 8); 
            });

            if (resultsChart) {
                resultsChart.destroy();
            }

            resultsChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: archetype.profile,
                    datasets: [{
                        label: 'Tu Perfil',
                        data: normalizedScores, 
                        backgroundColor: 'rgba(37, 99, 235, 0.2)',
                        borderColor: 'rgba(37, 99, 235, 1)',
                        borderWidth: 2
                    }]
                },
                options: {
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(0, 0, 0, 0.1)' },
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            pointLabels: { font: { size: 12 }, color: '#475569' },
                            suggestedMin: 0,
                            suggestedMax: 10,
                            ticks: { display: false }
                        }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }


        // --- EVENT LISTENERS ---
        startBtn.addEventListener('click', startEvaluation);
        nameInput.addEventListener('keyup', (e) => {
            if (e.key === 'Enter') startEvaluation();
        });
        ctaBtn.addEventListener('click', () => switchScreen('form'));
        submitBtn.addEventListener('click', () => {
             switchScreen('loading');
             setTimeout(() => switchScreen('thankyou'), 1500);
        });

    </script>
</body>
</html>

